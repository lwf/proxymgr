#!/usr/bin/env ruby
$LOAD_PATH.unshift File.expand_path(File.join(__FILE__, '..', '..', 'lib'))

require 'proxymgr'
require 'logger'

ProxyMgr.logger = Logger.new(STDOUT)
ProxyMgr.logger.level = Logger::DEBUG

sink            = ProxyMgr::Sink.new
service_manager = ProxyMgr::ServiceManager.new(sink)
config          = ProxyMgr::Config.new(service_manager)

Signal.trap(:INT) do 
  Thread.new { service_manager.shutdown }.join
  exit 0
end

loop do
  sleep 300
end
